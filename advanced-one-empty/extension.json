{
  "plugin_type": "widget",
  "name": "Advanced Opticon Workshop",
  "edit_page_url": "https://www.atticandbutton.us/products/khaki-showerproof-rubberised-parka",
  "form_schema": [
    {
      "default_value": ".product-single__add-to-cart",
      "field_type": "selector",
      "name": "selector",
      "label": "Selector",
      "options": null
    }
  ],
  "description": "",
  "options": {
    "html": "<div id=\"optimizely-extension-{{ extension.$instance }}\" class=\"advanced-opticon-workshop\">\n  Perfect for today's temperature of <br>\n  {{ weather.temperature }} Â°F in {{ weather.city }}\n</div>",
    "css": ".advanced-opticon-workshop {\n  background-color: #fff575;\n  border-bottom: 1px solid #e0d769;\n  color: #555;\n  padding: 10px;\n\tfont-weight: bold;\n  text-align: center;\n  font-size: 20px;\n}",
    "apply_js": "\nvar opticonWorkshop = {\n    // This is the API key for our external API\n    apiKey: '635dd60132394e6d05519fad6fc47062',\n    // This object stores the data we get back from the API and sends it to the HTML template for rendering\n    weather: {},\n    // This function makes a request to an external API\n    makeRequest: function(city) {\n        var request = new XMLHttpRequest();\n\n        // STEP 2\n        // Add URL endpoint to get weather data\n        // https://api.openweathermap.org/data/2.5/weather?q=Philadelphia,us&APPID=635dd60132394e6d05519fad6fc47062&units=imperial\n        request.open('GET', '', true);\n\n        request.onload = function() {\n            if (request.status >= 200 && request.status < 400) {\n                // Success!\n                var data = JSON.parse(request.responseText);\n                // STEP 3\n                // Add data to weather object\n\n                opticonWorkshop.addChanges(extension.selector);\n            };\n        };\n          \n        request.send();\n    }, \n    // This function adds the weather HTML element onto the page\n    addChanges: function(selector) {\n        var utils = optimizely.get('utils');\n        utils.waitForElement(selector)\n        .then(function(elem) {\n            var html = extension.$render({\n                extension: extension\n                // STEP 4\n                // Add weather data to HTML rendering\n            });\n            elem.insertAdjacentHTML('afterend', html);\n        });\n    }\n};\n\n// STEP 1: START HERE\n// Check if Optimizely has geolocation data available \n// if so, use this information to trigger a request\n\n// Insert location condition here\n// Make request to the external API\nopticonWorkshop.makeRequest(locationObject.city);\n\n",
    "undo_js": "var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);\nif (extensionElement) {\n  extensionElement.parentElement.removeChild(extensionElement);\n}\n"
  }
}